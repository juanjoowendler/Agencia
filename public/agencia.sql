-- TABLE GENERATIONS (SQLITE)

CREATE TABLE IF NOT EXISTS "Empleados" (
	"LEGAJO"	INTEGER NOT NULL,
	"NOMBRE"	TEXT(30) NOT NULL,
	"APELLIDO"	TEXT(50) NOT NULL,
	"TELEFONO_CONTACTO"	INTEGER NOT NULL,
	PRIMARY KEY("LEGAJO" AUTOINCREMENT)
);
CREATE TABLE IF NOT EXISTS "Interesados" (
	"ID"	INTEGER NOT NULL,
	"TIPO_DOCUMENTO"	TEXT(3) NOT NULL DEFAULT ('"DNI"'),
	"DOCUMENTO"	TEXT(10) NOT NULL,
	"NOMBRE"	TEXT(50) NOT NULL,
	"APELLIDO"	TEXT(50) NOT NULL,
	"RESTRINGIDO"	BOOLEAN NOT NULL DEFAULT (FALSE),
	"NRO_LICENCIA"	INTEGER NOT NULL UNIQUE,
	"FECHA_VENCIMIENTO_LICENCIA"	TIMESTAMP NOT NULL,
	PRIMARY KEY("ID" AUTOINCREMENT)
);
CREATE TABLE IF NOT EXISTS "Marcas" (
	"ID"	INTEGER NOT NULL,
	"NOMBRE"	TEXT(30) NOT NULL,
	PRIMARY KEY("ID" AUTOINCREMENT)
);
CREATE TABLE IF NOT EXISTS "Modelos" (
	"ID"	INTEGER NOT NULL,
	"ID_MARCA"	INTEGER NOT NULL,
	"DESCRIPCION"	TEXT NOT NULL,
	PRIMARY KEY("ID" AUTOINCREMENT),
	CONSTRAINT "Modelo_Marca_FK" FOREIGN KEY("ID_MARCA") REFERENCES "Marcas"("ID")
);
CREATE TABLE IF NOT EXISTS "Notificaciones" (
	"ID"	INTEGER NOT NULL,
	"LEGAJO"	INTEGER NOT NULL,
	"DESCRIPCION"	TEXT,
	PRIMARY KEY("ID" AUTOINCREMENT),
	CONSTRAINT "Notificaciones_Empleados_FK" FOREIGN KEY("LEGAJO") REFERENCES "Empleados"("LEGAJO")
);
CREATE TABLE IF NOT EXISTS "Posiciones" (
	"ID"	INTEGER NOT NULL,
	"ID_VEHICULO"	INTEGER NOT NULL,
	"FECHA_HORA"	TIMESTAMP NOT NULL DEFAULT (CURRENT_TIMESTAMP),
	"LATITUD"	REAL NOT NULL,
	"LONGITUD"	REAL NOT NULL,
	PRIMARY KEY("ID" AUTOINCREMENT),
	CONSTRAINT "Posiciones_Vehiculos_FK" FOREIGN KEY("ID_VEHICULO") REFERENCES "Vehiculos"("ID")
);
CREATE TABLE IF NOT EXISTS "Pruebas" (
	"ID"	INTEGER NOT NULL,
	"ID_VEHICULO"	INTEGER NOT NULL,
	"ID_INTERESADO"	INTEGER NOT NULL,
	"ID_EMPLEADO"	INTEGER NOT NULL,
	"FECHA_HORA_INICIO"	TIMESTAMP NOT NULL DEFAULT (CURRENT_TIMESTAMP),
	"FECHA_HORA_FIN"	TIMESTAMP NOT NULL DEFAULT (CURRENT_TIMESTAMP),
	"COMENTARIOS"	TEXT(500),
	PRIMARY KEY("ID" AUTOINCREMENT),
	CONSTRAINT "Pruebas_Empleados_FK" FOREIGN KEY("ID_EMPLEADO") REFERENCES "Empleados"("LEGAJO"),
	CONSTRAINT "Pruebas_Interesados_FK" FOREIGN KEY("ID_INTERESADO") REFERENCES "Interesados"("ID"),
	CONSTRAINT "Pruebas_Vehiculos_FK" FOREIGN KEY("ID_VEHICULO") REFERENCES "Vehiculos"("ID")
);
CREATE TABLE IF NOT EXISTS "Vehiculos" (
	"ID"	INTEGER NOT NULL,
	"PATENTE"	TEXT NOT NULL UNIQUE,
	"ID_MODELO"	INTEGER NOT NULL,
	"ANIO"	INTEGER NOT NULL DEFAULT (2019),
	PRIMARY KEY("ID" AUTOINCREMENT),
	CONSTRAINT "Vehiculos_Modelos_FK" FOREIGN KEY("ID_MODELO") REFERENCES "Modelos"("ID")
);

-- DIAGRAM GENERATOR (https://dbdiagram.io/d/agencia-diagram-671fd31097a66db9a38ce7b6)

// Use DBML to define your database structure
// Docs: https://dbml.dbdiagram.io/docs

Table Empleados {
  LEGAJO integer [primary key]
  NOMBRE varchar(30)
  APELLIDO varchar(50)
  TELEFONO_CONTACTO integer
}

Table Interesados {
  ID integer [primary key]
  TIPO_DOCUMENTO varchar(3) [default: 'DNI']
  DOCUMENTO varchar(10)
  NOMBRE varchar(50)
  APELLIDO varchar(50)
  RESTRINGIDO boolean [default: false]
  NRO_LICENCIA integer [unique]
  FECHA_VENCIMIENTO_LICENCIA timestamp
}

Table Marcas {
  ID integer [primary key]
  NOMBRE varchar(30)
}

Table Modelos {
  ID integer [primary key]
  ID_MARCA integer
  DESCRIPCION text
}

Table Notificaciones {
  ID integer [primary key]
  LEGAJO integer
  DESCRIPCION text
}

Table Posiciones {
  ID integer [primary key]
  ID_VEHICULO integer
  FECHA_HORA timestamp [default: 'CURRENT_TIMESTAMP']
  LATITUD real
  LONGITUD real
}

Table Pruebas {
  ID integer [primary key]
  ID_VEHICULO integer
  ID_INTERESADO integer
  ID_EMPLEADO integer
  FECHA_HORA_INICIO timestamp [default: 'CURRENT_TIMESTAMP']
  FECHA_HORA_FIN timestamp [default: 'CURRENT_TIMESTAMP']
  COMENTARIOS text(500)
}

Table Vehiculos {
  ID integer [primary key]
  PATENTE varchar
  ID_MODELO integer
  ANIO integer [default: 2019]
}

// Define the relationships between tables
Ref: Notificaciones.LEGAJO > Empleados.LEGAJO // many-to-one
Ref: Modelos.ID_MARCA > Marcas.ID // many-to-one
Ref: Posiciones.ID_VEHICULO > Vehiculos.ID // many-to-one
Ref: Pruebas.ID_EMPLEADO > Empleados.LEGAJO // many-to-one
Ref: Pruebas.ID_INTERESADO > Interesados.ID // many-to-one
Ref: Pruebas.ID_VEHICULO > Vehiculos.ID // many-to-one
Ref: Vehiculos.ID_MODELO > Modelos.ID // many-to-one


-- INSERTS


INSERT INTO "Empleados" ("LEGAJO","NOMBRE","APELLIDO","TELEFONO_CONTACTO") VALUES (1,'Ramiro','David',3519000001);
INSERT INTO "Empleados" ("LEGAJO","NOMBRE","APELLIDO","TELEFONO_CONTACTO") VALUES (2,'Mario','Pruebas',3519000002);
INSERT INTO "Empleados" ("LEGAJO","NOMBRE","APELLIDO","TELEFONO_CONTACTO") VALUES (3,'Germán','Darín',3519000003);
INSERT INTO "Interesados" ("ID","TIPO_DOCUMENTO","DOCUMENTO","NOMBRE","APELLIDO","RESTRINGIDO","NRO_LICENCIA","FECHA_VENCIMIENTO_LICENCIA") VALUES (1,'DNI','12345678','Juan','Pérez',0,1234567,'2025-12-31 00:00:00');
INSERT INTO "Interesados" ("ID","TIPO_DOCUMENTO","DOCUMENTO","NOMBRE","APELLIDO","RESTRINGIDO","NRO_LICENCIA","FECHA_VENCIMIENTO_LICENCIA") VALUES (2,'DNI','23456789','María','Gómez',1,2345678,'2025-12-31 00:00:00');
INSERT INTO "Interesados" ("ID","TIPO_DOCUMENTO","DOCUMENTO","NOMBRE","APELLIDO","RESTRINGIDO","NRO_LICENCIA","FECHA_VENCIMIENTO_LICENCIA") VALUES (3,'DNI','34567890','Carlos','López',0,3456789,'2025-12-31 00:00:00');
INSERT INTO "Interesados" ("ID","TIPO_DOCUMENTO","DOCUMENTO","NOMBRE","APELLIDO","RESTRINGIDO","NRO_LICENCIA","FECHA_VENCIMIENTO_LICENCIA") VALUES (4,'DNI','45678901','Ana','Martínez',0,4567890,'2025-12-31 00:00:00');
INSERT INTO "Interesados" ("ID","TIPO_DOCUMENTO","DOCUMENTO","NOMBRE","APELLIDO","RESTRINGIDO","NRO_LICENCIA","FECHA_VENCIMIENTO_LICENCIA") VALUES (5,'DNI','56789012','Luis','Fernández',1,5678901,'2025-12-31 00:00:00');
INSERT INTO "Interesados" ("ID","TIPO_DOCUMENTO","DOCUMENTO","NOMBRE","APELLIDO","RESTRINGIDO","NRO_LICENCIA","FECHA_VENCIMIENTO_LICENCIA") VALUES (6,'DNI','67890123','Sofía','Rodríguez',0,6789012,'2025-12-31 00:00:00');
INSERT INTO "Interesados" ("ID","TIPO_DOCUMENTO","DOCUMENTO","NOMBRE","APELLIDO","RESTRINGIDO","NRO_LICENCIA","FECHA_VENCIMIENTO_LICENCIA") VALUES (7,'DNI','78901234','Fernando','Hernández',1,7890123,'2025-12-31 00:00:00');
INSERT INTO "Interesados" ("ID","TIPO_DOCUMENTO","DOCUMENTO","NOMBRE","APELLIDO","RESTRINGIDO","NRO_LICENCIA","FECHA_VENCIMIENTO_LICENCIA") VALUES (8,'DNI','89012345','Valentina','Sánchez',0,8901234,'2025-12-31 00:00:00');
INSERT INTO "Interesados" ("ID","TIPO_DOCUMENTO","DOCUMENTO","NOMBRE","APELLIDO","RESTRINGIDO","NRO_LICENCIA","FECHA_VENCIMIENTO_LICENCIA") VALUES (9,'DNI','90123456','Andrés','Gutiérrez',0,9012345,'2025-12-31 00:00:00');
INSERT INTO "Interesados" ("ID","TIPO_DOCUMENTO","DOCUMENTO","NOMBRE","APELLIDO","RESTRINGIDO","NRO_LICENCIA","FECHA_VENCIMIENTO_LICENCIA") VALUES (10,'DNI','1234567','Lucía','Ramírez',1,1234569,'2025-12-31 00:00:00');
INSERT INTO "Interesados" ("ID","TIPO_DOCUMENTO","DOCUMENTO","NOMBRE","APELLIDO","RESTRINGIDO","NRO_LICENCIA","FECHA_VENCIMIENTO_LICENCIA") VALUES (11,'DNI','34567890','Carlos','Pérez',0,3456889,'2024-01-01 00:00:00');
INSERT INTO "Interesados" ("ID","TIPO_DOCUMENTO","DOCUMENTO","NOMBRE","APELLIDO","RESTRINGIDO","NRO_LICENCIA","FECHA_VENCIMIENTO_LICENCIA") VALUES (12,'DNI','45678901','Ana','Torres',1,4517890,'2023-12-31 00:00:00');
INSERT INTO "Interesados" ("ID","TIPO_DOCUMENTO","DOCUMENTO","NOMBRE","APELLIDO","RESTRINGIDO","NRO_LICENCIA","FECHA_VENCIMIENTO_LICENCIA") VALUES (13,'DNI','56789012','Javier','Gómez',0,5673901,'2024-06-30 00:00:00');
INSERT INTO "Marcas" ("ID","NOMBRE") VALUES (1,'Alfa Romeo');
INSERT INTO "Marcas" ("ID","NOMBRE") VALUES (2,'Audi');
INSERT INTO "Marcas" ("ID","NOMBRE") VALUES (3,'BAIC');
INSERT INTO "Marcas" ("ID","NOMBRE") VALUES (4,'BMW');
INSERT INTO "Marcas" ("ID","NOMBRE") VALUES (5,'CHERY');
INSERT INTO "Marcas" ("ID","NOMBRE") VALUES (6,'Chevrolet');
INSERT INTO "Marcas" ("ID","NOMBRE") VALUES (7,'Chrysler');
INSERT INTO "Marcas" ("ID","NOMBRE") VALUES (8,'Citröen');
INSERT INTO "Marcas" ("ID","NOMBRE") VALUES (9,'Dodge');
INSERT INTO "Marcas" ("ID","NOMBRE") VALUES (10,'DS');
INSERT INTO "Marcas" ("ID","NOMBRE") VALUES (11,'FIAT');
INSERT INTO "Marcas" ("ID","NOMBRE") VALUES (12,'Ford');
INSERT INTO "Marcas" ("ID","NOMBRE") VALUES (13,'Geely');
INSERT INTO "Marcas" ("ID","NOMBRE") VALUES (14,'Hoda');
INSERT INTO "Marcas" ("ID","NOMBRE") VALUES (15,'Hyundai');
INSERT INTO "Marcas" ("ID","NOMBRE") VALUES (16,'Jeep');
INSERT INTO "Marcas" ("ID","NOMBRE") VALUES (17,'Kia');
INSERT INTO "Marcas" ("ID","NOMBRE") VALUES (18,'Mercedes Benz');
INSERT INTO "Marcas" ("ID","NOMBRE") VALUES (19,'Nissan');
INSERT INTO "Marcas" ("ID","NOMBRE") VALUES (20,'Peugeot');
INSERT INTO "Marcas" ("ID","NOMBRE") VALUES (21,'Renault');
INSERT INTO "Marcas" ("ID","NOMBRE") VALUES (22,'Toyota');
INSERT INTO "Marcas" ("ID","NOMBRE") VALUES (23,'Volkswagen');
INSERT INTO "Marcas" ("ID","NOMBRE") VALUES (24,'Volvo');
INSERT INTO "Modelos" ("ID","ID_MARCA","DESCRIPCION") VALUES (1,1,'147 5P 2,0 TS DISTINCTIVE');
INSERT INTO "Modelos" ("ID","ID_MARCA","DESCRIPCION") VALUES (2,2,'A4 4P 1,8 TFSI ATTRACTION MULTI');
INSERT INTO "Modelos" ("ID","ID_MARCA","DESCRIPCION") VALUES (3,3,'X35 5P 1,5 T CVT FASHION');
INSERT INTO "Modelos" ("ID","ID_MARCA","DESCRIPCION") VALUES (4,4,'325 COUPE 2,5 i EXECUTIVE');
INSERT INTO "Modelos" ("ID","ID_MARCA","DESCRIPCION") VALUES (5,5,'Fulwin 5P 1,5');
INSERT INTO "Modelos" ("ID","ID_MARCA","DESCRIPCION") VALUES (6,6,'Agile 5P 1,4 LTZ');
INSERT INTO "Modelos" ("ID","ID_MARCA","DESCRIPCION") VALUES (7,7,'300 4P 5,7 C HEMI ATX');
INSERT INTO "Modelos" ("ID","ID_MARCA","DESCRIPCION") VALUES (8,8,'C3 Aircross 5P 1,6 16V SEGURIDAD');
INSERT INTO "Modelos" ("ID","ID_MARCA","DESCRIPCION") VALUES (9,9,'Journey 5P 2,4 SE 2F AT ');
INSERT INTO "Modelos" ("ID","ID_MARCA","DESCRIPCION") VALUES (10,10,'DS 3 3P 1,6 VTi SPORT CHIC');
INSERT INTO "Modelos" ("ID","ID_MARCA","DESCRIPCION") VALUES (11,11,'500 2P 1,4 16V 100CV SPORT');
INSERT INTO "Modelos" ("ID","ID_MARCA","DESCRIPCION") VALUES (12,12,'Ecosport 5P 1,6 FREESTYLE');
INSERT INTO "Modelos" ("ID","ID_MARCA","DESCRIPCION") VALUES (13,13,'515 5P 1,5 HATCH GS');
INSERT INTO "Modelos" ("ID","ID_MARCA","DESCRIPCION") VALUES (14,14,'Accord 4P 2,0 T EXT 10AT');
INSERT INTO "Modelos" ("ID","ID_MARCA","DESCRIPCION") VALUES (15,15,'Santa Fe 5P 2,7 V6 4WD GLS 7P');
INSERT INTO "Modelos" ("ID","ID_MARCA","DESCRIPCION") VALUES (16,16,'Cherokee 5P 2,8 CRD SPORT AT');
INSERT INTO "Modelos" ("ID","ID_MARCA","DESCRIPCION") VALUES (17,17,'Cerato 4P 1,6 EX FORTE');
INSERT INTO "Modelos" ("ID","ID_MARCA","DESCRIPCION") VALUES (18,18,'A200 5P BLUEEFFICIENCY STYLE ');
INSERT INTO "Modelos" ("ID","ID_MARCA","DESCRIPCION") VALUES (19,19,'Leaf 5P TEKNA');
INSERT INTO "Modelos" ("ID","ID_MARCA","DESCRIPCION") VALUES (20,20,'207 3P 1,6 XT COMPACT PREMIUM');
INSERT INTO "Modelos" ("ID","ID_MARCA","DESCRIPCION") VALUES (21,21,'Captur 5P 1,6 LE COP SPORTIF CVT');
INSERT INTO "Modelos" ("ID","ID_MARCA","DESCRIPCION") VALUES (22,22,'Etios 5P 1,5 X C/AUDIO');
INSERT INTO "Modelos" ("ID","ID_MARCA","DESCRIPCION") VALUES (23,23,'Gol Trend 3P 1,6 GP PACK I ');
INSERT INTO "Modelos" ("ID","ID_MARCA","DESCRIPCION") VALUES (24,24,'C30 3P 2,0 AT P2 ');
INSERT INTO "Pruebas" ("ID","ID_VEHICULO","ID_INTERESADO","ID_EMPLEADO","FECHA_HORA_INICIO","FECHA_HORA_FIN","COMENTARIOS") VALUES (9,1,1,1,1730415600000,1730426400000,'');
INSERT INTO "Pruebas" ("ID","ID_VEHICULO","ID_INTERESADO","ID_EMPLEADO","FECHA_HORA_INICIO","FECHA_HORA_FIN","COMENTARIOS") VALUES (10,1,1,1,1725231600000,1725242400000,'');
INSERT INTO "Pruebas" ("ID","ID_VEHICULO","ID_INTERESADO","ID_EMPLEADO","FECHA_HORA_INICIO","FECHA_HORA_FIN","COMENTARIOS") VALUES (12,2,4,3,1729983600000,1729986088014,'Prueba finalziada antes de tiempo.');
INSERT INTO "Pruebas" ("ID","ID_VEHICULO","ID_INTERESADO","ID_EMPLEADO","FECHA_HORA_INICIO","FECHA_HORA_FIN","COMENTARIOS") VALUES (13,2,4,3,1729990800000,1729994400000,'');
INSERT INTO "Pruebas" ("ID","ID_VEHICULO","ID_INTERESADO","ID_EMPLEADO","FECHA_HORA_INICIO","FECHA_HORA_FIN","COMENTARIOS") VALUES (14,2,4,3,1730077200000,1730078765349,'Prueba finalizada (estamos con juan)');
INSERT INTO "Vehiculos" ("ID","PATENTE","ID_MODELO","ANIO") VALUES (1,'ZZ000ZZ',1,2015);
INSERT INTO "Vehiculos" ("ID","PATENTE","ID_MODELO","ANIO") VALUES (2,'ZZ111AA',2,2019);
INSERT INTO "Vehiculos" ("ID","PATENTE","ID_MODELO","ANIO") VALUES (3,'ZZ012FT',3,2024);
INSERT INTO "Vehiculos" ("ID","PATENTE","ID_MODELO","ANIO") VALUES (4,'ZZ001GG',4,2016);
INSERT INTO "Vehiculos" ("ID","PATENTE","ID_MODELO","ANIO") VALUES (5,'ZZZ001',5,2004);
INSERT INTO "Vehiculos" ("ID","PATENTE","ID_MODELO","ANIO") VALUES (6,'ZZ444AA',8,2017);


-- Posiciones que NO exceden el radio admitido y NO están en áreas restringidas
INSERT INTO Posiciones (ID, ID_VEHICULO, FECHA_HORA, LATITUD, LONGITUD) VALUES
(1, 1, '2024-11-02 10:00:00', 42.509000, 1.535000), -- Cerca de la agencia, en zona segura
(2, 2, '2024-11-02 10:30:00', 42.509500, 1.534800); -- Dentro del radio y en zona segura

-- Posiciones que exceden el radio admitido de 5 km
INSERT INTO Posiciones (ID, ID_VEHICULO, FECHA_HORA, LATITUD, LONGITUD) VALUES
(3, 3, '2024-11-02 11:00:00', 42.600000, 1.600000), -- Lejos de la agencia, fuera del radio permitido
(4, 4, '2024-11-02 11:30:00', 42.700000, 1.700000); -- Muy lejos, claramente fuera del radio

-- Posiciones que están DENTRO de áreas restringidas
INSERT INTO Posiciones (ID, ID_VEHICULO, FECHA_HORA, LATITUD, LONGITUD) VALUES
(5, 5, '2024-11-02 12:00:00', 42.508900, 1.537000), -- Dentro de la primera área restringida
(6, 6, '2024-11-02 12:30:00', 42.507500, 1.536000), -- Dentro de la segunda área restringida
(7, 1, '2024-11-02 13:00:00', 42.510200, 1.530500); -- Dentro de la tercera área restringida

-- Posiciones que NO están en áreas restringidas y están dentro del radio admitido
INSERT INTO Posiciones (ID, ID_VEHICULO, FECHA_HORA, LATITUD, LONGITUD) VALUES
(8, 2, '2024-11-02 13:30:00', 42.509300, 1.534500), -- Dentro del radio, en zona segura
(9, 3, '2024-11-02 14:00:00', 42.508500, 1.535200); -- Cerca de la agencia, en zona segura




